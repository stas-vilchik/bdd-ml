{
  ancestorInfo = ancestorInfo || emptyAncestorInfo;
  var parentInfo = ancestorInfo.current;
  var parentTag = parentInfo && parentInfo.tag;

  if (childText != null) {
    warning(
      childTag == null,
      "validateDOMNesting: when childText is passed, childTag should be null"
    );
    childTag = "#text";
  }

  var invalidParent = isTagValidWithParent(childTag, parentTag)
    ? null
    : parentInfo;
  var invalidAncestor = invalidParent
    ? null
    : findInvalidAncestorForTag(childTag, ancestorInfo);
  var invalidParentOrAncestor = invalidParent || invalidAncestor;

  if (!invalidParentOrAncestor) {
    return;
  }

  var ancestorInstance = invalidParentOrAncestor.instance;
  var ancestorTag = invalidParentOrAncestor.tag;
  var addendum;

  if (childInstance != null) {
    addendum =
      " See " +
      getOwnerInfo(
        childInstance,
        childTag,
        ancestorInstance,
        ancestorTag,
        !!invalidParent
      ) +
      ".";
  } else {
    addendum = getCurrentFiberStackAddendum();
  }

  var warnKey =
    !!invalidParent + "|" + childTag + "|" + ancestorTag + "|" + addendum;

  if (didWarn[warnKey]) {
    return;
  }

  didWarn[warnKey] = true;
  var tagDisplayName = childTag;
  var whitespaceInfo = "";

  if (childTag === "#text") {
    if (/\S/.test(childText)) {
      tagDisplayName = "Text nodes";
    } else {
      tagDisplayName = "Whitespace text nodes";
      whitespaceInfo =
        " Make sure you don't have any extra whitespace between tags on " +
        "each line of your source code.";
    }
  } else {
    tagDisplayName = "<" + childTag + ">";
  }

  if (invalidParent) {
    var info = "";

    if (ancestorTag === "table" && childTag === "tr") {
      info +=
        " Add a <tbody> to your code to match the DOM tree generated by " +
        "the browser.";
    }

    warning(
      false,
      "validateDOMNesting(...): %s cannot appear as a child of <%s>.%s%s%s",
      tagDisplayName,
      ancestorTag,
      whitespaceInfo,
      info,
      addendum
    );
  } else {
    warning(
      false,
      "validateDOMNesting(...): %s cannot appear as a descendant of " +
        "<%s>.%s",
      tagDisplayName,
      ancestorTag,
      addendum
    );
  }
}
